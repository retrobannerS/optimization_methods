\section{Задание №3(Вариант 51)}\label{03-lab}
\subsection{Условие}\label{03-lab-condition}

Составить и решить геометрически и сиплекс-методом задачу, двойственную данной:
\begin{align*}
    &F = 3x_1 + x_2 \to \max\\
    &\begin{cases}
        2x_1 + x_2 \leq 2\\
        -x_1 + 3x_2 \leq 3\\
        x_1 \geq 0, x_2 \geq 0
    \end{cases}
\end{align*}

\subsection{Решение}\label{03-lab-solution}

\subsubsection{Составление двойственной задачи}
Согласно решению \hyperref[01-lab-a-answer]{задания №1 пункта А}, мы нашли решение этой прямой задачи:
\begin{align*}
    \max F(x_1, x_2) = 3, \argmax F(x_1, x_2) = (1, 0);\\
\end{align*} 

Поэтому, по коэффициентам в системе и по определению, составляем задачу, двойственную данной:
\begin{align*}
    &F^{*} = 2y_1 + 3y_2 \to \min\\
    &\begin{cases}
        2y_1 - y_2 \geq 3\\
        y_1 + 3y_2 \geq 1\\
        y_1 \geq 0\\
        y_2 \geq 0
    \end{cases}
\end{align*}

\subsubsection{Решение двойственной задачи по второй теореме двойственности}

\begin{Th}{Вторая теорема двойственности}\end{Th}

\begin{align*}
    \mathbf{x^{ *}} = (x_{ 1}^{ *} , x_{ 2}^{ *} , \dots , x_{ n}^{ *}) \text{ и } \mathbf{y^{ *}} = (y_{ 1}^{ *} , y_{ 2}^{ *} , \dots , y_{ n}^{ *}) &\text{--- оптимальные решения прямой}\\
    \text{и двойственной задач}
    &\Leftrightarrow
    \begin{aligned}
        &\left(\sum_{j = 1}^{n} a_{ ij} x_{ j}^{ *} - b_{ i}\right)y_{ i}^{ *} = 0 \ \forall i = \overline{1, m}; \\
        &\left(\sum_{i=1}^{n} a_{ ij} y_{ i}^{ *} - c_{ j}\right)x_{ j}^{ *} = 0 \ \forall j = \overline{1, n}; 
    \end{aligned}
\end{align*}

$ \mathbf{x^{ *}} $ был найден в \hyperref[01-lab-a-answer]{задании №1, пункт А} и \hyperref[02-lab-a-answer]{задании №2, пункт А}: $ \mathbf{x^{ *}} = \left(1, 0\right) $

Подставим в первое равенство:
\begin{align*}
    &\left(\sum_{j=1}^{2} a_{ 1j}x_{j}^{ *} - b_{ 1}\right)y_{ 1}^{ *}   =  \left(2\cdot1 + 1 \cdot 0 - 2\right)y_{ 1}^{ *} = 0 \cdot y_1^*  = 0 \Leftrightarrow y_1^* \geq 0\\
    &\left(\sum_{j=1}^{2} a_{ 2j}x_{j}^{ *} - b_{ 2}\right)y_{ 2}^{ *}   =   \left(-1 \cdot 1 + 3 \cdot 0 - 3\right)y_2^* = -4 \cdot y_2^* = 0 \Leftrightarrow y_2^* = 0
\end{align*}

Подставим полученное во второе равенство:
\begin{align*}
    &   \left(\sum_{i=1}^{2} a_{ i1} y_{ i}^{ *} - c_{ 1}\right)x_{ 1}^{ *} = \left(2 \cdot y_1^* - 1 \cdot y_2^* - 3\right)x_1^* = \left(2 \cdot y_1^* - 1 \cdot 0 - 3\right) \cdot 1 = 2 \cdot y_1^* - 3 = 0 \Leftrightarrow y_1^* = \dfrac{ 3}{ 2}   \\
    &   \left(\sum_{i=1}^{2} a_{ i2} y_{ i}^{ *} - c_{ 2}\right)x_{ 2}^{ *} = \left(1 \cdot y_1^* + 3 \cdot y_2^* - 1\right)x_2^* = \left(1 \cdot y_1^* + 3 \cdot 0 - 1\right) \cdot 0 = 0 \Leftrightarrow y_2^* \geq 0
\end{align*}

Таким образом $ \mathbf{y^*} = \left( \dfrac{ 3}{ 2}, 0\right) $ --- оптимальное решение. Подставим в функцию: $ F^* = 2 \cdot \dfrac{ 3}{ 2} + 3 \cdot 0 = 3 = F_{ \min}^* $ 

\subsubsection{Решение двойственной задачи по третьей теореме двойственности}

\begin{Th}{Третья теорема двойственности}\end{Th}

$\mathbf{y^*} = \overrightarrow{c} \cdot A_B^{-1}$, \hspace{20pt} где $\overrightarrow{c}$ --- коэффициенты в функции при базисных переменных, $A_B$ --- матрица, составленная из компонент векторов,
вошедших в оптимальных базис.

Согласно \hyperref[02-lab-a]{заданию №2, пункт А} выводим первую и последнюю симплекс-таблицы:

\begin{table}[H]
    \centering
    \begin{tabular}{|c|>{\columncolor[HTML]{98FB98}}c|c|c|c|c|c|}
        \hline
        Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $b_i$ & $\dfrac{b_i}{\text{решающий столбец}}$ \\
        \hline
        \rowcolor[HTML]{E0FFFF}
        $x_3$ & \cellcolor[HTML]{BDFDCC} 2 & 1 & 1 & 0 & 2 & 1 \leftarrow min\\
        \hline
        $x_4$ & {-1} & 3 & 0 & 1 & 3 & -3 < 0\\
        \hline
        F & -3 \leftarrow min & -1 & 0 & 0 & 0 & \\
        \hline
    \end{tabular}
    \caption{Начальная симплекс-таблица}
    \label{03-lab-01-table}
\end{table}

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|c|}
        \hline
        &Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $b_i$ & $\dfrac{b_i}{\text{решающий столбец}}$ \\
        \hline
        &$x_1$ & 2 & 1 & 1 & 0 & 2 &\\
        \hline
        &$x_4$ & 0 & 7 & 1 & 2 & 8 &\\
        \hline
        &2F & 0 & 1 & 3 & 0 & 6 & Все > 0\\
        \hline
    \end{tabular}
    \caption{Оптимальная симплекс-таблица}
    \label{03-lab-02-table}
\end{table}

Смотрим в последнюю таблицу: базисные элементы $ x_1 $ и $ x_4 $. 
\begin{enumerate}
    \item Коэффициенты в функции перед $ x_1 $ и $ x_4 $ : $ \overrightarrow{c} = \begin{pmatrix}
        3 & 0
    \end{pmatrix} $
    \item Берём из первой таблицы столбцы при $ x_1 $ и $ x_4 $ и получаем матрицу 
    $ 
    \begin{pmatrix}
        2 & 0\\
        -1 & 1
    \end{pmatrix} 
    $.\\
    \item Находим для неё обратную матрицу $ \begin{pmatrix}
        \frac{ 1}{ 2}   & 0\\
        \frac{ 1}{ 2}   & 1
    \end{pmatrix} $
\end{enumerate}
 

По теореме находим $ \mathbf{y^*}  $:

\[ \mathbf{y^*}= \begin{pmatrix}
    y_1^* & y_2^*
\end{pmatrix}= \overrightarrow{c} \cdot A_B^{ -1} = \begin{pmatrix}
    3 & 0
\end{pmatrix} \cdot 
    \begin{pmatrix}
        \frac{ 1}{ 2} & 0\\
        \frac{ 1}{ 2} & 1
    \end{pmatrix} = \begin{pmatrix}
        \frac{ 3}{ 2} & 0
    \end{pmatrix}
;\]

Подставив в функцию, получаем то же, что получили предыдущим способом: $ F^{ *} = F_{ \min}^{ *} = 3 $

\begin{Th}{Первая теорема двойственности}\end{Th}
Если одна из пары двойственных задач имеет оптимальное решение, 
то и другая имеет оптимальное решение, 
причем значения целевых функций задач при их оптимальных планах равны между собой: $F(x^*) = F^*(y^*)$. 
Если же целевая функция одной из пары двойственных задач не ограничена, то другая задача вообще не имеет планов (ОДР пуста).

Как мы можем видеть, значения найденной нами функции $ F^* = F^*_{ min} $ совпало с ответом к заданиям \hyperref[01-lab-a-answer]{№1, пункт А} и \hyperref[02-lab-a-answer]{№2, пункт А}:
$ F^*\left(y_1^*, y_2^*\right) = F^*_{ min} = F\left(x_1^*, x_2^*\right) = F_{ max} = 3 $

\textbf{Ответ:} $ \argmin F^* = \begin{pmatrix}
    \frac{ 3}{ 2} & 0   
\end{pmatrix}, \min F^* = 3 $.
