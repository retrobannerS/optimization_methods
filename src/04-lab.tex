\section{Задание №4 (Вариант 3)}\label{04-lab}

\subsection{Условие}\label{04-lab-condition}
Для следующего текстового условия составить математическую модель для прямой и двойственной задачи. Получить решение прямой и двойственной задач
симплекс-методом. Дать экономическую интерпретацию двойственных задачи двойственных оценок.

Для производства четырех видов изделий $(A, B, C)$ предприятие использует три вида сырья: металл, пластмассу, резину.
Запасы сырья, технологические коэффициенты (расход каждого вида сырья на производство единицы каждого изделия)
представлены в Таблице \ref{04-lab-01-table}. В ней же указана прибыль от реализации одного изделия каждого вида.
Требуется составить такой план выпуска указанных изделий, чтобы обеспечить максимальную прибыль.

\begin{table}[H]
    \centering
    \begin{tabular}{|>{\columncolor{lightgray}}c|c|c|c|c|c|}
        \hline
        \rowcolor{lightgray} Сырьё & A & B & C & D & Запасы \\ \hline
        Металл                     & 9 & 7 & 8 & 4 & 1500   \\ \hline
        Пластмасса                 & 6 & 1 & 4 & 2 & 1000   \\ \hline
        Резина                     & 3 & 1 & 2 & 0 & 700    \\ \hline
        \textbf{Прибыль} (руб)     & 1 & 2 & 4 & 5 & ~      \\ \hline
    \end{tabular}
    \caption{}
    \label{04-lab-01-table}
\end{table}

\subsection{Решение}\label{04-lab-solution}

\subsubsection{Математические модели}

Прямая задача:

\begin{align*}
     & F(x_{ 1}, x_{ 2}, x_{ 3} , x_{ 4}) = x_{ 1} + 2x_{ 2} + 4x_{ 3} + 5x_4 \to \max \\
     & \begin{cases}
           9x_1 + 7x_2 + 8x_3 + 4x_4 \leq 1500 \\
           6x_1 + x_2 + 4x_3 + 2x_4 \leq 1000  \\
           3x_1 + x_2 + 2x_3 \leq 700
       \end{cases}                                             \\
     & x_i \geq 0, \ \forall i\in\overline{1,4}
\end{align*}

Обратная задача:

\begin{align*}
     & F^{ *}(y_{ 1}, y_{ 2}, y_{ 3}) = 1500y_{ 1} + 1000y_{ 2} + 700y_{ 3} \to \min \\
     & \begin{cases}
           9y_1 + 6y_2 + 3y_3 \geq 1 \\
           7y_1 + y_2 + y_3 \geq 2   \\
           8y_1 + 4y_2 + 2y_3 \geq 4 \\
           4y_1 + 2y_2 \geq 5
       \end{cases}                                                     \\
     & y_i \geq 0, \ \forall i\in\overline{1,4}
\end{align*}

\subsubsection{Решение прямой задачи симплекс-методом}

Приведём прямую задачу к каноническому виду:

\begin{align*}
     & F - x_{ 1} - 2x_{ 2} - 4x_{ 3} - 5x_4 = 0 \\
     & \begin{cases}
           9x_1 + 7x_2 + 8x_3 + 4x_4 + x_5 = 1500 \\
           6x_1 + x_2 + 4x_3 + 2x_4 + x_6 = 1000  \\
           3x_1 + x_2 + 2x_3 + x_7 = 700
       \end{cases}    \\
\end{align*}

И решим её с помощью симплекс-таблиц:

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|c|>{\columncolor{mycolumncolor}}c|c|c|c|c|c|}
        \hline
                           & Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$         & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{разрешающий столбец}}$ \\ \hline
        \myrowcolor
                           & $x_5$ & 9     & 7     & 8     & \mycellcolor4 & 1     & 0     & 0     & 1500  & 375                                      \\ \hline
        $\mathbf{\cdot 2}$ & $x_6$ & 6     & 1     & 4     & 2             & 0     & 1     & 0     & 1000  & 500                                      \\ \hline
                           & $x_7$ & 3     & 1     & 2     & 0             & 0     & 0     & 1     & 700   & +\infty                                  \\ \hline
        $\mathbf{\cdot 4}$ & F     & -1    & -2    & -4    & -5            & 0     & 0     & 0     &       &                                          \\ \hline
    \end{tabular}
    \caption{}
    \label{04-lab-02-table}
\end{table}

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|c|>{\columncolor{mycolumncolor}}c|c|c|c|c|c|}
        \hline
         & Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$         & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{разрешающий столбец}}$ \\ \hline
        \myrowcolor
         & $x_5$ & 9     & 7     & 8     & \mycellcolor4 & 1     & 0     & 0     & 1500  & 375                                      \\ \hline
         & $x_6$ & 12    & 2     & 8     & 4             & 0     & 2     & 0     & 2000  & 500                                      \\ \hline
         & $x_7$ & 3     & 1     & 2     & 0             & 0     & 0     & 1     & 700   & +\infty                                  \\ \hline
         & 4F    & -4    & -8    & -16   & -20           & 0     & 0     & 0     & 0     &                                          \\ \hline
    \end{tabular}
    \caption{}
    \label{04-lab-03-table}
\end{table}

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
         & Базис & $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$ & $b_i$ & $\frac{b_i}{\text{разрешающий столбец}}$ \\ \hline
         & $x_4$ & 9     & 7     & 8     & 4     & 1     & 0     & 0     & 1500  &                                          \\ \hline
         & $x_6$ & 3     & -5    & 0     & 0     & -1    & 2     & 0     & 500   &                                          \\ \hline
         & $x_7$ & 3     & 1     & 2     & 0     & 0     & 0     & 1     & 700   &                                          \\ \hline
         & 4F    & 41    & 27    & 24    & 0     & 5     & 0     & 0     & 7500  & \text{Все > 0}                           \\ \hline
    \end{tabular}
    \caption{}
    \label{04-lab-04-table}
\end{table}

Мы решили задачу оптимизации, перейдя в точку $\overrightarrow{x} = \left(0; 0; 0; 375; 0; 250; 700\right)$
А также получили выражение для максимума: $ 4F_{ \max} + 41x_1 + 27x_2 + 24x_3 + 5x_5 = 7500 $, откуда $ F_{ \max} = 1875 $

\subsubsection{Решение двойственной задачи по третьей теореме двойственности}

Смотрим в таблицу \ref{04-lab-04-table}: базисные элементы $ x_4 $, $ x_6 $ и $ x_7 $.

\begin{enumerate}
    \item Коэффициенты в функции перед $ x_4 $, $ x_6 $ и $ x_7 $ : $ \overrightarrow{c} = \begin{pmatrix}
                  5 & 0 & 0
              \end{pmatrix} $
    \item Берём из таблицы \ref{04-lab-02-table} столбцы при $ x_4 $, $ x_6 $ и $ x_7 $ и получаем матрицу
          $
              \begin{pmatrix}
                  4 & 0 & 0 \\
                  4 & 1 & 0 \\
                  0 & 0 & 1
              \end{pmatrix}
          $.\\
    \item Находим для неё обратную матрицу $ A^{ -1}_{ B} = \begin{pmatrix}
                  \frac{ 1}{ 4} & 0 & 0 \\
                  - \frac{1}{2} & 1 & 0 \\
                  0             & 0 & 1
              \end{pmatrix} $
\end{enumerate}

По теореме находим $ \mathbf{y^*}  $:

\[ \mathbf{y^*}= \begin{pmatrix}
        y_1^* & y_2^* & y_3^*
    \end{pmatrix}= \overrightarrow{c} \cdot A_B^{ -1} = \begin{pmatrix}
        5 & 0 & 0
    \end{pmatrix} \cdot
    \begin{pmatrix}
        \frac{ 1}{ 4} & 0 & 0 \\
        - \frac{1}{2} & 1 & 0 \\
        0             & 0 & 1
    \end{pmatrix} = \begin{pmatrix}
        \frac{ 5}{ 4} & 0 & 0
    \end{pmatrix}
    ;\]

Подставив в функцию $ F^{ *}(y_{ 1}, y_{ 2}, y_{ 3}) = 1500y_{ 1} + 1000y_{ 2} + 700y_{ 3} $, получаем то же, что получили предыдущим способом: $ F^{ *} = F_{ \min}^{ *} = 1875 $,
значение сошлось с решением прямой задачи.

\subsubsection{Анализ результатов}

Подставим $ \mathbf{x^*} = \left(0; 0; 0; 375\right)$ в условия прямой задачи:

\[
    \begin{cases}
        9 \cdot 0 + 7 \cdot 0 + 8 \cdot 0 + 4 \cdot 375 = 1500 \\
        6 \cdot 0 + 0 + 4 \cdot 0 + 2 \cdot 375 = 750 < 1000   \\
        3 \cdot 0 + 0 + 2 \cdot 0 = 0 < 700
    \end{cases}
\]

Второе и третье условия имеют строгий знак $<$, значит второй и третий ресурсы (пластмасса и резина) не являются дефицитными (остатки 250 и 700 соответственно).

Первое условие образует равенство $=$, значит первый ресурс (металл) дефицитен.

Подставим $ \mathbf{y^*} = \begin{pmatrix} \frac{ 5}{ 4} & 0 & 0 \end{pmatrix}$ в условия двойственной задачи:

\[
    \begin{cases}
        9 \cdot \frac{5}{4} + 6 \cdot 0 + 3 \cdot 0 = \frac{ 45}{ 4} > 1 \\
        7 \cdot \frac{5}{4} + 0 + 0 \geq 2 = \frac{ 35}{ 4} > 2          \\
        8 \cdot \frac{5}{4} + 4 \cdot 0 + 2 \cdot 0 = 10 > 4             \\
        4 \cdot \frac{5}{4} + 2 \cdot 0 = 5
    \end{cases}
\]

Первое, второе и третье условия имеют строгий знак $>$, следовательно, производить эти изделия экономически невыгодно.

Четвёртое условие имеет равенство $=$, следовательно, двойственная оценка ресурса, используемого для изготовления продукта в точности равна доходам, а значит продукт выгодно производить.

Величина двойственных оценок показывает, насколько возрастает целевая функция при увеличении запасов дефицитного ресурса на единицу.
Увеличение запасов ресурса Р1 (металл) на единицу приведет к новому оптимальному плану.
Коэффициенты $A_B^{-1}$ показывают, что увеличение прибыли достигается засчет увеличения выпуска продукции $D$, при этом запасы пластмассы сократятся на $\frac{1}{2}$ единиц.

Ответ: $\mathbf{x^*} = \begin{pmatrix} 0 & 0 & 0 & 375 \end{pmatrix}, \mathbf{y^*} = \begin{pmatrix} \frac{5}{4} & 0 & 0 \end{pmatrix}$\label{04-lab-answer}

\subsubsection{Анализ устойчивости двойственных оценок}\label{04-lab-stability}

Определим интервалы устойчивости:
\[x^*_{B\text{нов}} = x_B + A_B^{-1} \cdot (b + \Delta b)\]
\[ A_B^{-1} \cdot (b + \Delta b) \geq 0 \]

\[
    A_B^{-1} \cdot (b + \Delta b) = \begin{pmatrix}
        \frac{1}{4}  & 0 & 0 \\
        -\frac{1}{2} & 1 & 0 \\
        0            & 0 & 1
    \end{pmatrix} \cdot \begin{pmatrix}
        1500 + \Delta b_1 \\
        1000 + \Delta b_2 \\
        700 + \Delta b_3
    \end{pmatrix} = \begin{pmatrix}
        375 + \frac{1}{4} \Delta b_1              \\
        500 - \frac{1}{2} \Delta b_1 + \Delta b_2 \\
        700 + \Delta b_3
    \end{pmatrix} \geq 0
\]

Рассмотрим частные случаи:
\begin{enumerate}
    \item $\Delta b_1 \geq 0, \Delta b_2 = 0, \Delta b_3 = 0$:
          \[
              \begin{pmatrix}
                  375 + \frac{1}{4} \Delta b_1 \\
                  500 - \frac{1}{2} \Delta b_1 \\
                  700
              \end{pmatrix} \geq 0 \Leftrightarrow \begin{cases}
                  375 + \frac{1}{4} \Delta b_1 \geq 0 \\
                  500 - \frac{1}{2} \Delta b_1 \geq 0
              \end{cases} \Leftrightarrow \begin{cases}
                  \Delta b_1 \geq -1500 \\
                  \Delta b_1 \leq 1000
              \end{cases} \Leftrightarrow -1500 \leq \Delta b_1 \leq 1000
          \]
          При увеличении запасов 1-го ресурса не более чем на 1000 единиц и уменьшении его запасов не более чем на 1500 единиц значение целевой функции не изменится.
    \item $\Delta b_1 = 0, \Delta b_2 \geq 0, \Delta b_3 = 0$:
          \[
              \begin{pmatrix}
                  375              \\
                  500 + \Delta b_2 \\
                  700
              \end{pmatrix} \geq 0
              \Leftrightarrow 500 + \Delta b_2 \geq 0 \Leftrightarrow \Delta b_2 \geq -500
          \]
          При уменьшении запасов 2-го ресурса не более чем на 500 единиц, при этом оптимальный план двойственной задачи не изменится.
    \item $\Delta b_1 = 0, \Delta b_2 = 0, \Delta b_3 \geq 0$:
          \[
              \begin{pmatrix}
                  375 \\
                  500 \\
                  700 + \Delta b_3
              \end{pmatrix} \geq 0
              \Leftrightarrow 700 + \Delta b_3 \geq 0 \Leftrightarrow \Delta b_3 \geq -700
          \]
          При уменьшении запасов 3-го ресурса не более чем на 700 единиц, при этом оптимальный план двойственной задачи не изменится.
\end{enumerate}

Предположим: $\Delta b_1 = 1000, \Delta b_2 = -500$:

\[
    \begin{pmatrix}
        x_4^{\text{нов}} \\
        x_6^{\text{нов}} \\
        x_7^{\text{нов}}
    \end{pmatrix}
    =
    \begin{pmatrix}
        375 + \frac{1}{4} \cdot 1000       \\
        500 - \frac{1}{2} \cdot 1000 - 500 \\
        700
    \end{pmatrix} = \begin{pmatrix}
        625 \\
        0   \\
        700
    \end{pmatrix} \geq 0
\]

Подставим новые значения в целевую функцию:
\[F^{\text{нов}}_{\max} = x_{ 1}^{\text{нов}} + 2x_{ 2}^{\text{нов}} + 4x_{ 3}^{\text{нов}} + 5x_4^{\text{нов}} = 0 + 2 \cdot 0 + 4 \cdot 0 + 5 \cdot 625 = 3125\]

\newpage